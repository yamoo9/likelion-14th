<!DOCTYPE html>
<html lang="ko-KR">
<head>
  <meta charset="UTF-8" />
  <title>GitHub 인증 실습</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body>

  <main>
    <h1>📦 내 GitHub 저장소 목록 보기</h1>
    <form>
      <label for="github-personal-access-token">GitHub 개인 엑세스 토큰</label>
      <input
        type="text" 
        id="github-personal-access-token" 
        placeholder="GitHub 개인 엑세스 토큰 입력"
        size="60"
      />
      <button type="submit">저장소 목록 가져오기</button>
    </form>
    <ul data-id="repoList"></ul>
  </main>

  <script>
    // 여기에 코드를 작성합니다.
    {
      const GITHUB_ENDPOINT = 'https://api.github.com/user/repos'
      // const GITHUB_ENDPOINT = 'https://api.github.com/users/yamoo9/repos'
      const repoList = document.querySelector('[data-id="repoList"]')
      const form = document.querySelector('form')

      form.addEventListener('submit', (e) => {
        e.preventDefault()

        const form = e.currentTarget
        const [tokenInput] = form.elements
        const token = tokenInput.value.trim()
        // console.log(token)
        
        fetchGitHubUserRepos(token)
          .then((data) => {
            console.log(data)
            // renderRepos(data)
          })

        form.reset()
      })

      function fetchGitHubUserRepos(token) {
        return fetch(GITHUB_ENDPOINT, {
          method: 'POST',
        })
          .then((response) => response.json())
          .catch(console.error)
      }

      function renderRepos(data) {
        console.log(repoList, data)
      }

    }
  </script>
</body>
</html>